<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Chapter&nbsp;5.&nbsp;CouchDB API Server Database Methods</title>
<link href="epub.css" type="text/css" rel="stylesheet" />
<meta content="DocBook XSL Stylesheets V1.76.1" name="generator" />
</head>
<body>
<div class="chapter" title="Chapter&nbsp;5.&nbsp;CouchDB API Server Database Methods">
<div class="titlepage">
<div>
<div>
<h1 class="title">
<a id="couchdb-api-db" />Chapter&nbsp;5.&nbsp;CouchDB API Server Database Methods</h1>
</div>
</div>
</div>
<p>
    The Database methods provide an interface to an entire database
    withing CouchDB. These are database, rather than document, level
    requests.
  </p>
<p>
    A list of the available methods and URL paths are provided below:
  </p>
<div class="table">
<a id="table-couchdb-api-db-summary" />
<p class="title">
<strong>Table&nbsp;5.1.&nbsp;Database API Calls</strong>
</p>
<div class="table-contents">
<table summary="Database API Calls" border="1">
<colgroup>
<col class="method" width="33%" />
<col class="path" width="33%" />
<col class="desc" width="34%" />
</colgroup>
<thead>
<tr>
<th>Method</th>
<th>Path</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<code class="literal">GET</code>
</td>
<td>
<code class="literal">/db</code>
</td>
<td>
<a class="link" href="ch05.html#couchdb-api-db_db_get" title="5.1.&nbsp;GET /db">
 Returns database information
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">PUT</code>
</td>
<td>
<code class="literal">/db</code>
</td>
<td>
<a class="link" href="ch05s02.html" title="5.2.&nbsp;PUT /db">
 Create a new database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">DELETE</code>
</td>
<td>
<code class="literal">/db</code>
</td>
<td>
<a class="link" href="ch05s03.html" title="5.3.&nbsp;DELETE /db">
 Delete an existing database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">GET</code>
</td>
<td>
<code class="literal">/db/_all_docs</code>
</td>
<td>
<a class="link" href="ch05s12.html" title="5.12.&nbsp;GET /db/_all_docs">
 Returns a built-in view of all documents in this database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_all_docs</code>
</td>
<td>
<a class="link" href="ch05s13.html" title="5.13.&nbsp;POST /db/_all_docs">
 Returns certain rows from the built-in view of all documents
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_bulk_docs</code>
</td>
<td>
<a class="link" href="ch05s09.html" title="5.9.&nbsp;POST /db/_bulk_docs">
 Insert multiple documents in to the database in a single request
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">GET</code>
</td>
<td>
<code class="literal">/db/_changes</code>
</td>
<td>
<a class="link" href="ch05s04.html" title="5.4.&nbsp;GET /db/_changes">
 Returns changes for the given database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_compact</code>
</td>
<td>
<a class="link" href="ch05s05.html" title="5.5.&nbsp;POST /db/_compact">
 Starts a compaction for the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_compact/design-doc</code>
</td>
<td>
<a class="link" href="ch05s06.html" title="5.6.&nbsp;POST /db/_compact/design-doc">
 Starts a compaction for all the views in the selected design
 document
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_ensure_full_commit</code>
</td>
<td>
<a class="link" href="ch05s08.html" title="5.8.&nbsp;POST /db/_ensure_full_commit">
 Makes sure all uncommitted changes are written and synchronized
 to the disk
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_missing_revs</code>
</td>
<td>
<a class="link" href="ch05s14.html" title="5.14.&nbsp;POST /db/_missing_revs">
 Given a list of document revisions, returns the document
 revisions that do not exist in the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_purge</code>
</td>
<td>
<a class="link" href="ch05s11.html" title="5.11.&nbsp;POST /db/_purge">
 Purge some historical documents entirely from database history
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_revs_diff</code>
</td>
<td>
<a class="link" href="ch05s15.html" title="5.15.&nbsp;POST /db/_revs_diff">
 Given a list of document revisions, returns differences between
 the given revisions and ones that are in the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">GET</code>
</td>
<td>
<code class="literal">/db/_revs_limit</code>
</td>
<td>
<a class="link" href="ch05s18.html" title="5.18.&nbsp;GET /db/_revs_limit">
 Gets the limit of historical revisions to store for a single
 document in the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">PUT</code>
</td>
<td>
<code class="literal">/db/_revs_limit</code>
</td>
<td>
<a class="link" href="ch05s19.html" title="5.19.&nbsp;PUT /db/_revs_limit">
 Sets the limit of historical revisions to store for a single
 document in the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">GET</code>
</td>
<td>
<code class="literal">/db/_security</code>
</td>
<td>
<a class="link" href="ch05s16.html" title="5.16.&nbsp;GET /db/_security">
 Returns the special security object for the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">PUT</code>
</td>
<td>
<code class="literal">/db/_security</code>
</td>
<td>
<a class="link" href="ch05s17.html" title="5.17.&nbsp;PUT /db/_security">
 Sets the special security object for the database
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_temp_view</code>
</td>
<td>
<a class="link" href="ch05s10.html" title="5.10.&nbsp;POST /db/_temp_view">
 Execute a given view function for all documents and return the
 result
 </a>
</td>
</tr>
<tr>
<td>
<code class="literal">POST</code>
</td>
<td>
<code class="literal">/db/_view_cleanup</code>
</td>
<td>
<a class="link" href="ch05s07.html" title="5.7.&nbsp;POST /db/_view_cleanup">
 Removes view files that are not used by any design document
 </a>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>
    For all the database methods, the database name within the URL path
    should be the database name that you wish to perform the operation
    on. For example, to obtain the meta information for the database
    <code class="literal">recipes</code>, you would use the HTTP request:
  </p>
<pre class="programlisting">GET /recipes</pre>
<p>
    For clarity, the form below is used in the URL paths:
  </p>
<pre class="programlisting">GET /db</pre>
<p>
    Where <code class="literal">db</code> is the name of any database.
  </p>
<div class="section" title="5.1.&nbsp;GET /db">
<div class="titlepage">
<div>
<div>
<h1 class="title">
<a id="couchdb-api-db_db_get" />5.1.&nbsp;<code class="literal">GET /db</code>
</h1>
</div>
</div>
</div>
<div class="informaltable">
<table summary="URL API GET /db" border="1">
<colgroup>
<col class="field" width="33%" />
<col class="info" width="33%" />
<col class="addinfo" width="34%" />
</colgroup>
<tbody>
<tr>
<td>
<span class="bold">
<strong>Method</strong>
</span>
</td>
<td colspan="2">
<code class="literal">GET /db</code>
</td>
</tr>
<tr>
<td>
<span class="bold">
<strong>Request</strong>
</span>
</td>
<td colspan="2">
 None
 </td>
</tr>
<tr>
<td>
<span class="bold">
<strong>Response</strong>
</span>
</td>
<td colspan="2">
 Information about the database in JSON format
 </td>
</tr>
<tr>
<td>
<span class="bold">
<strong>Admin Privileges Required</strong>
</span>
</td>
<td colspan="2">no</td>
</tr>
<tr>
<td colspan="3">
<span class="bold">
<strong>Return Codes</strong>
</span>
</td>
</tr>
<tr>
<td>404</td>
<td colspan="2">
 The requested content could not be found. The returned content
 will include further information, as a JSON object, if available.
 </td>
</tr>
</tbody>
</table>
</div>
<p>
      Gets information about the specified database. For example, to
      retrieve the information for the database
      <code class="literal">recipe</code>:
    </p>
<div xmlns="" class="httprequest">
<div class="httprequest-title">HTTP Request</div>
<pre class="programlisting">
<programlisting>httprequestlinespecificGET http://couchdb:5984/recipes
Accept: application/json</programlisting>
</pre>
</div>
<p xmlns="http://www.w3.org/1999/xhtml">
      The JSON response contains meta information about the database. A
      sample of the JSON returned for an empty database is provided
      below:
    </p>
<div xmlns="" class="httpresponse">
<div class="httpresponse-title">HTTP Response</div>
<pre class="programlisting">
<programlisting>httpresponselinespecific{
   "compact_running" : false,
   "committed_update_seq" : 375048,
   "disk_format_version" : 5,
   "disk_size" : 33153123,
   "doc_count" : 18386,
   "doc_del_count" : 0,
   "db_name" : "recipes",
   "instance_start_time" : "1290700340925570",
   "purge_seq" : 10,
   "update_seq" : 375048
}</programlisting>
</pre>
</div>
<p xmlns="http://www.w3.org/1999/xhtml">
      The elements of the returned structure are shown in the table
      below:
    </p>
<div class="table">
<a id="table-couchdb-api-db-json-db-info" />
<p class="title">
<strong>Table&nbsp;5.2.&nbsp;
 CouchDB database information object
 </strong>
</p>
<div class="table-contents">
<table summary="
 CouchDB database information object
 " border="1">
<colgroup>
<col class="item" width="30%" />
<col class="desc" width="70%" />
</colgroup>
<tbody>
<tr>
<td>
<span class="bold">
<strong>Field</strong>
</span>
</td>
<td>
<span class="bold">
<strong>Description</strong>
</span>
</td>
</tr>
<tr>
<td>
<code class="literal">committed_update_seq</code>  </td>
<td>
 The number of committed update.
 </td>
</tr>
<tr>
<td>
<code class="literal">compact_running</code>  </td>
<td>
 Set to true if the database compaction routine is operating on
 this database.
 </td>
</tr>
<tr>
<td>
<code class="literal">db_name</code>  </td>
<td>
 The name of the database.
 </td>
</tr>
<tr>
<td>
<code class="literal">disk_format_version</code>  </td>
<td>
 The version of the physical format used for the data when it is
 stored on disk.
 </td>
</tr>
<tr>
<td>
<code class="literal">disk_size</code>  </td>
<td>
 Size in bytes of the data as stored on the disk. Views indexes
 are not included in the calculation.
 </td>
</tr>
<tr>
<td>
<code class="literal">doc_count</code>  </td>
<td>
 A count of the documents in the specified database.
 </td>
</tr>
<tr>
<td>
<code class="literal">doc_del_count</code>  </td>
<td>
 Number of deleted documents
 </td>
</tr>
<tr>
<td>
<code class="literal">instance_start_time</code>  </td>
<td>
 Timestamp of when the database was created, expressed in
 milliseconds since the epoch.
 </td>
</tr>
<tr>
<td>
<code class="literal">purge_seq</code>  </td>
<td>
 The number of purge operations on the database.
 </td>
</tr>
<tr>
<td>
<code class="literal">update_seq</code>  </td>
<td>
 The current number of updates to the database.
 </td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</body>
</html>
